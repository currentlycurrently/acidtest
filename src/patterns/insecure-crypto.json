{
  "category": "insecure-crypto",
  "patterns": [
    {
      "id": "crypto-001",
      "name": "MD5 hash algorithm usage",
      "description": "MD5 is cryptographically broken and should not be used for security purposes",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(createHash|hashlib\\.(md5|new)).*['\"]md5['\"]",
        "flags": "i"
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use secure hash algorithms",
        "suggestions": [
          "Use SHA-256 or SHA-3 for hashing",
          "For passwords, use bcrypt, scrypt, or Argon2",
          "MD5 is vulnerable to collision attacks",
          "For TypeScript: crypto.createHash('sha256')",
          "For Python: hashlib.sha256()"
        ]
      }
    },
    {
      "id": "crypto-002",
      "name": "SHA-1 hash algorithm usage",
      "description": "SHA-1 is deprecated and vulnerable to collision attacks",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "(createHash|hashlib\\.(sha1|new)).*['\"]sha1['\"]",
        "flags": "i"
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use SHA-256 or better",
        "suggestions": [
          "Migrate to SHA-256, SHA-384, or SHA-512",
          "SHA-1 is deprecated by NIST since 2011",
          "Vulnerable to collision attacks (SHAttered attack)",
          "Use SHA-256 minimum for new applications"
        ]
      }
    },
    {
      "id": "crypto-003",
      "name": "Weak random number generation",
      "description": "Math.random() is not cryptographically secure",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "Math\\.random\\(\\)",
        "flags": ""
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use cryptographically secure random",
        "suggestions": [
          "For TypeScript: Use crypto.randomBytes() or crypto.getRandomValues()",
          "For Python: Use secrets module instead of random",
          "Math.random() is predictable and not suitable for security",
          "Never use Math.random() for tokens, keys, or security-sensitive operations"
        ]
      }
    },
    {
      "id": "crypto-004",
      "name": "Python random module for security (Python)",
      "description": "Python's random module is not cryptographically secure",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "import random|from random import",
        "flags": ""
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use secrets module",
        "suggestions": [
          "Use 'import secrets' instead of 'import random' for security",
          "secrets.token_bytes(), secrets.token_hex(), secrets.token_urlsafe()",
          "random module uses Mersenne Twister which is predictable",
          "Only use random module for non-security purposes (games, simulations)"
        ]
      }
    },
    {
      "id": "crypto-005",
      "name": "Hardcoded secret or API key",
      "description": "Hardcoded secrets in source code are a security risk",
      "severity": "CRITICAL",
      "match": {
        "type": "regex",
        "value": "(api[_-]?key|secret|password|token|auth)\\s*=\\s*['\"][a-zA-Z0-9_-]{20,}['\"]",
        "flags": "i"
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use environment variables",
        "suggestions": [
          "Store secrets in environment variables (process.env.API_KEY)",
          "Use a secrets management service (AWS Secrets Manager, HashiCorp Vault)",
          "Never commit secrets to version control",
          "Use .env files (but add .env to .gitignore)",
          "Rotate any secrets that were accidentally committed"
        ]
      }
    },
    {
      "id": "crypto-006",
      "name": "DES/3DES cipher usage",
      "description": "DES and 3DES are obsolete and insecure encryption algorithms",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(createCipher|Cipher\\.getInstance).*['\"]?(DES|3DES|TripleDES)['\"]?",
        "flags": "i"
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use AES encryption",
        "suggestions": [
          "Use AES-256-GCM or AES-256-CBC for encryption",
          "DES has a 56-bit key which is too weak",
          "3DES is deprecated and slow",
          "For TypeScript: crypto.createCipheriv('aes-256-gcm', key, iv)",
          "For Python: Use cryptography library with AES"
        ]
      }
    },
    {
      "id": "crypto-007",
      "name": "ECB cipher mode usage",
      "description": "ECB mode does not provide message confidentiality",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(createCipher|Cipher\\.getInstance).*ECB",
        "flags": "i"
      },
      "layer": "code",
      "category": "insecure-crypto",
      "remediation": {
        "title": "Use GCM or CBC mode",
        "suggestions": [
          "Use AES-GCM mode (provides authentication)",
          "Use AES-CBC mode with HMAC for authentication",
          "ECB mode reveals patterns in plaintext",
          "ECB is deterministic - same plaintext produces same ciphertext",
          "Never use ECB mode for encrypting more than one block"
        ]
      }
    }
  ]
}
