{
  "category": "dangerous-imports",
  "patterns": [
    {
      "id": "pyimp-001",
      "name": "subprocess-module",
      "description": "Imports subprocess module for command execution",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(import\\s+subprocess|from\\s+subprocess\\s+import)",
        "flags": "g"
      },
      "layer": "code",
      "remediation": {
        "title": "Avoid subprocess when possible",
        "suggestions": [
          "Use built-in Python APIs instead of shell commands",
          "If subprocess is necessary, never use shell=True",
          "Never pass user input directly to subprocess functions",
          "Use explicit argument lists with subprocess.run([cmd, arg1, arg2])",
          "Validate and sanitize all command arguments"
        ]
      }
    },
    {
      "id": "pyimp-002",
      "name": "os-system-import",
      "description": "Imports os module which provides os.system() for command execution",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "(import\\s+os|from\\s+os\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-003",
      "name": "eval-builtin",
      "description": "Uses eval() builtin for arbitrary code execution",
      "severity": "CRITICAL",
      "match": {
        "type": "regex",
        "value": "\\beval\\s*\\(",
        "flags": "g"
      },
      "layer": "code",
      "remediation": {
        "title": "Replace eval() with safer alternatives",
        "suggestions": [
          "Use json.loads() for parsing JSON strings",
          "Use ast.literal_eval() for safely evaluating Python literals",
          "Consider removing dynamic code execution entirely",
          "If absolutely necessary, validate and sanitize all inputs"
        ]
      }
    },
    {
      "id": "pyimp-004",
      "name": "exec-builtin",
      "description": "Uses exec() builtin for arbitrary code execution",
      "severity": "CRITICAL",
      "match": {
        "type": "regex",
        "value": "\\bexec\\s*\\(",
        "flags": "g"
      },
      "layer": "code",
      "remediation": {
        "title": "Avoid exec() for dynamic code execution",
        "suggestions": [
          "Refactor to use static function definitions",
          "Use importlib for dynamic module loading instead",
          "If truly necessary, ensure all code is from trusted sources only",
          "Consider using a restricted globals/locals dictionary"
        ]
      }
    },
    {
      "id": "pyimp-005",
      "name": "compile-builtin",
      "description": "Uses compile() builtin for code object creation",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "\\bcompile\\s*\\(",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-006",
      "name": "pickle-module",
      "description": "Imports pickle module for unsafe deserialization",
      "severity": "CRITICAL",
      "match": {
        "type": "regex",
        "value": "(import\\s+pickle|from\\s+pickle\\s+import)",
        "flags": "g"
      },
      "layer": "code",
      "remediation": {
        "title": "Replace pickle with safer serialization",
        "suggestions": [
          "Use json for data serialization when possible",
          "For complex objects, consider msgpack or protobuf",
          "Never unpickle data from untrusted sources",
          "If pickle is required, use hmac to verify data integrity",
          "Consider using restricted unpicklers with custom find_class()"
        ]
      }
    },
    {
      "id": "pyimp-007",
      "name": "shelve-module",
      "description": "Imports shelve module which uses pickle internally",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(import\\s+shelve|from\\s+shelve\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-008",
      "name": "marshal-module",
      "description": "Imports marshal module for unsafe deserialization",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(import\\s+marshal|from\\s+marshal\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-009",
      "name": "import-builtin",
      "description": "Uses __import__ builtin for dynamic imports",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "\\b__import__\\s*\\(",
        "flags": "g"
      },
      "layer": "code",
      "remediation": {
        "title": "Replace dynamic imports with static imports",
        "suggestions": [
          "Use static import statements when possible",
          "Use importlib.import_module() with whitelisted module names",
          "Validate module names against a known set before importing",
          "Consider using entry points or plugin systems instead"
        ]
      }
    },
    {
      "id": "pyimp-010",
      "name": "importlib-import",
      "description": "Uses importlib for dynamic module imports",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "(import\\s+importlib|from\\s+importlib\\s+import|importlib\\.import_module)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-011",
      "name": "ctypes-module",
      "description": "Imports ctypes for native code execution",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(import\\s+ctypes|from\\s+ctypes\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-012",
      "name": "cffi-module",
      "description": "Imports cffi for native code execution",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "(import\\s+cffi|from\\s+cffi\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-013",
      "name": "socket-module",
      "description": "Imports socket module for network access",
      "severity": "LOW",
      "match": {
        "type": "regex",
        "value": "(import\\s+socket|from\\s+socket\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-014",
      "name": "requests-module",
      "description": "Imports requests module for HTTP requests",
      "severity": "LOW",
      "match": {
        "type": "regex",
        "value": "(import\\s+requests|from\\s+requests\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-015",
      "name": "urllib-module",
      "description": "Imports urllib for URL/HTTP operations",
      "severity": "LOW",
      "match": {
        "type": "regex",
        "value": "(import\\s+urllib|from\\s+urllib)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-016",
      "name": "httpx-module",
      "description": "Imports httpx module for HTTP requests",
      "severity": "LOW",
      "match": {
        "type": "regex",
        "value": "(import\\s+httpx|from\\s+httpx\\s+import)",
        "flags": "g"
      },
      "layer": "code"
    },
    {
      "id": "pyimp-017",
      "name": "input-builtin",
      "description": "Uses input() for user input which could be dangerous",
      "severity": "LOW",
      "match": {
        "type": "regex",
        "value": "\\binput\\s*\\(",
        "flags": "g"
      },
      "layer": "code"
    }
  ]
}
