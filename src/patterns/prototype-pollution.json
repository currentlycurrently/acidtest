{
  "category": "prototype-pollution",
  "patterns": [
    {
      "id": "proto-001",
      "name": "Direct __proto__ access",
      "description": "Direct access or modification of __proto__ can lead to prototype pollution",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "__proto__|\\[\\s*['\"]__proto__['\"]\\s*\\]",
        "flags": ""
      },
      "layer": "code",
      "category": "prototype-pollution",
      "remediation": {
        "title": "Avoid __proto__ access",
        "suggestions": [
          "Use Object.create(null) to create objects without prototype",
          "Use Object.setPrototypeOf() if prototype modification is necessary",
          "Validate and sanitize object keys before assignment",
          "Use Object.freeze() to prevent prototype modification",
          "Never allow user input to set object properties dynamically"
        ]
      }
    },
    {
      "id": "proto-002",
      "name": "constructor.prototype manipulation",
      "description": "Modifying constructor.prototype can affect all instances",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "constructor\\[\\s*['\"]prototype['\"]\\s*\\]|constructor\\.prototype\\[",
        "flags": ""
      },
      "layer": "code",
      "category": "prototype-pollution",
      "remediation": {
        "title": "Avoid prototype manipulation",
        "suggestions": [
          "Validate object keys before dynamic property access",
          "Use Object.create(null) for user-controlled objects",
          "Implement key whitelisting for dynamic properties",
          "Consider using Map instead of plain objects for key-value storage"
        ]
      }
    },
    {
      "id": "proto-003",
      "name": "Object merge without key validation",
      "description": "Merging objects without validating keys can lead to prototype pollution",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "(Object\\.assign|\\.\\.\\.|merge|extend)\\([^)]*\\)",
        "flags": ""
      },
      "layer": "code",
      "category": "prototype-pollution",
      "remediation": {
        "title": "Validate keys during merge",
        "suggestions": [
          "Validate that source objects don't contain __proto__, constructor, or prototype",
          "Use a safe merge function that filters dangerous keys",
          "Consider using libraries like 'lodash.merge' with proper configuration",
          "Implement a key whitelist for allowed properties"
        ]
      }
    }
  ]
}
