{
  "category": "xss-injection",
  "patterns": [
    {
      "id": "xss-001",
      "name": "dangerouslySetInnerHTML usage",
      "description": "React's dangerouslySetInnerHTML can introduce XSS vulnerabilities",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "dangerouslySetInnerHTML",
        "flags": "i"
      },
      "layer": "code",
      "category": "xss-injection",
      "remediation": {
        "title": "Sanitize HTML content",
        "suggestions": [
          "Use DOMPurify or similar library to sanitize HTML before rendering",
          "Prefer using React's default JSX rendering which auto-escapes",
          "If HTML rendering is necessary, use a sanitization library like 'isomorphic-dompurify'",
          "Validate that HTML content comes from trusted sources only"
        ]
      }
    },
    {
      "id": "xss-002",
      "name": "innerHTML property assignment",
      "description": "Direct innerHTML assignment can lead to XSS vulnerabilities",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "\\.innerHTML\\s*=",
        "flags": ""
      },
      "layer": "code",
      "category": "xss-injection",
      "remediation": {
        "title": "Use safe DOM manipulation",
        "suggestions": [
          "Use textContent instead of innerHTML for text-only content",
          "Use createElement() and appendChild() for safe DOM manipulation",
          "If HTML is required, sanitize with DOMPurify first",
          "Consider using a framework that auto-escapes by default"
        ]
      }
    },
    {
      "id": "xss-003",
      "name": "document.write usage",
      "description": "document.write can introduce XSS and is generally considered harmful",
      "severity": "MEDIUM",
      "match": {
        "type": "regex",
        "value": "document\\.write(ln)?\\(",
        "flags": ""
      },
      "layer": "code",
      "category": "xss-injection",
      "remediation": {
        "title": "Use modern DOM manipulation",
        "suggestions": [
          "Use createElement() and appendChild() instead",
          "Use innerHTML with sanitization if necessary",
          "document.write is obsolete and should be avoided",
          "Can cause issues with page loading and XSS vulnerabilities"
        ]
      }
    },
    {
      "id": "xss-004",
      "name": "eval with HTML/DOM strings",
      "description": "Using eval with HTML strings can lead to XSS",
      "severity": "CRITICAL",
      "match": {
        "type": "regex",
        "value": "eval\\([^)]*(<[^>]+>|innerHTML|outerHTML)",
        "flags": "i"
      },
      "layer": "code",
      "category": "xss-injection",
      "remediation": {
        "title": "Never use eval with HTML",
        "suggestions": [
          "Remove eval usage entirely",
          "Use JSON.parse() for data parsing",
          "Use proper DOM APIs for HTML manipulation",
          "eval is dangerous and should be avoided in all cases"
        ]
      }
    },
    {
      "id": "xss-005",
      "name": "location.href with user input",
      "description": "Assigning user input to location.href can enable XSS via javascript: URLs",
      "severity": "HIGH",
      "match": {
        "type": "regex",
        "value": "location\\.(href|replace|assign)\\s*=\\s*[^'\"]*\\$",
        "flags": ""
      },
      "layer": "code",
      "category": "xss-injection",
      "remediation": {
        "title": "Validate and sanitize URLs",
        "suggestions": [
          "Validate that URLs start with http:// or https://",
          "Reject javascript:, data:, and vbscript: URL schemes",
          "Use URL parsing to validate URL structure",
          "Consider using window.location.origin + path instead of full user-controlled URLs"
        ]
      }
    }
  ]
}
